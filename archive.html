<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Archive â€” Prototype Archive</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="favicon.ico">
</head>

<body>

  <h1>Archive</h1>
  <p>Public list of submitted working prototypes.</p>

  <div class="table-wrapper">
    <table id="prototypeTable">
      <thead>
        <tr>
          <th>Date</th>
          <th>Name</th>
          <th>Description</th>
          <th>Category</th>
          <th>Link</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <p><a href="index.html">Home</a></p>

  <script>
    const sheetURL =
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vSxO1VUamLS7wjknI02XN8NTWMr4EASsELHqe44VTGK4l7kQ-v4ZXZ7JAYMcD_Y1vxMHuTSw50OgLvr/pub?output=csv";

    fetch(sheetURL)
      .then(res => res.text())
      .then(csv => {
        const rows = csv.trim().split("\n").slice(1);
        const tbody = document.querySelector("#prototypeTable tbody");

        rows.forEach(row => {
          // Basic CSV-safe split (handles commas inside quotes)
          const cols = row.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g);
          if (!cols || cols.length < 5) return;

          const timestampRaw = cols[0].replace(/"/g, "").trim();
          const name = cols[1].replace(/"/g, "").trim();
          const desc = cols[2].replace(/"/g, "").trim();
          const category = cols[3].replace(/"/g, "").trim();
          let link = cols[4].replace(/"/g, "").trim();

          // Format date (YYYY-MM-DD)
          const date = new Date(timestampRaw).toISOString().split("T")[0];

          if (!link.startsWith("http")) {
            link = "https://" + link;
          }

          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${date}</td>
            <td>${name}</td>
            <td>${desc}</td>
            <td>${category}</td>
            <td><a href="${link}" target="_blank">Demo</a></td>
          `;

          tbody.appendChild(tr);
        });
      });
  </script>

</body>
</html>
